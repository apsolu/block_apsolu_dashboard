{"version":3,"file":"set_active_tab.min.js","sources":["../src/set_active_tab.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Enregistre le dernier onglet utilisé sur le tableau de bord dans les préférences de l'utilisateur afin de réafficher\n * automatiquement cet onglet lors de la prochaine visite du tableau de bord.\n *\n * @module     block_apsolu_dashboard/set_active_tab\n * @copyright  2023 Université Rennes 2 <dsi-contact@univ-rennes2.fr>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n// Note: à remplacer par core_user/repository lorsqu'on sera en Moodle 4.3.\ndefine([\"block_apsolu_dashboard/preference\", \"core/notification\"], function(UserRepository, Notification) {\n    return {\n        initialise: function(activeTab, userid) {\n            let tabSelector = \"#block-apsolu-dashboard-nav-tabs li a[aria-controls=\\\"\" + activeTab + \"\\\"]\";\n            let tab = document.querySelector(tabSelector);\n            if (tab) {\n                // Active l'onglet.\n                let currentActiveTab = document.querySelector(\"#block-apsolu-dashboard-nav-tabs li a.nav-link.active\");\n                if (currentActiveTab.getAttribute(\"aria-controls\") != activeTab) {\n                    // Retire les classes sur l'onglet actuellement actif.\n                    let currentActiveTabName = currentActiveTab.getAttribute(\"aria-controls\");\n                    currentActiveTab.classList.remove(\"active\");\n                    currentActiveTab.setAttribute(\"tabindex\", \"-1\");\n                    currentActiveTab.setAttribute(\"aria-selected\", \"false\");\n                    document.querySelector(\"#apsolu-dashboard-tab-content #\" + currentActiveTabName).\n                        classList.remove(...[\"active\", \"show\"]);\n\n                    // Ajoute les classes sur l'onglet à afficher.\n                    tab.classList.add(\"active\");\n                    tab.setAttribute(\"tabindex\", \"0\");\n                    tab.setAttribute(\"aria-selected\", \"true\");\n                    document.querySelector(\"#apsolu-dashboard-tab-content #\" + activeTab).classList.add(...[\"active\", \"show\"]);\n                }\n            }\n\n            // Ajoute un écouteur sur chaque onglet pour enregistrer les préférences.\n            document.querySelectorAll(\"#block-apsolu-dashboard-nav-tabs li a.nav-link\").forEach(function(tab) {\n                tab.addEventListener(\"click\", function() {\n                    let value = tab.getAttribute(\"aria-controls\");\n                    UserRepository.setUserPreference(\"block_apsolu_dahsboard_active_tab\", value, userid)\n                        .catch(Notification.exception);\n                });\n            });\n        },\n    };\n});\n"],"names":["define","UserRepository","Notification","initialise","activeTab","userid","tabSelector","tab","document","querySelector","currentActiveTab","getAttribute","currentActiveTabName","classList","remove","setAttribute","add","querySelectorAll","forEach","addEventListener","value","setUserPreference","catch","exception"],"mappings":";;;;;;;;AAyBAA,+CAAO,CAAC,oCAAqC,sBAAsB,SAASC,eAAgBC,oBACjF,CACHC,WAAY,SAASC,UAAWC,YACxBC,YAAc,wDAA2DF,UAAY,KACrFG,IAAMC,SAASC,cAAcH,gBAC7BC,IAAK,KAEDG,iBAAmBF,SAASC,cAAc,4DAC1CC,iBAAiBC,aAAa,kBAAoBP,UAAW,KAEzDQ,qBAAuBF,iBAAiBC,aAAa,iBACzDD,iBAAiBG,UAAUC,OAAO,UAClCJ,iBAAiBK,aAAa,WAAY,MAC1CL,iBAAiBK,aAAa,gBAAiB,SAC/CP,SAASC,cAAc,kCAAoCG,sBACvDC,UAAUC,OAAW,SAAU,QAGnCP,IAAIM,UAAUG,IAAI,UAClBT,IAAIQ,aAAa,WAAY,KAC7BR,IAAIQ,aAAa,gBAAiB,QAClCP,SAASC,cAAc,kCAAoCL,WAAWS,UAAUG,IAAQ,SAAU,SAK1GR,SAASS,iBAAiB,kDAAkDC,SAAQ,SAASX,KACzFA,IAAIY,iBAAiB,SAAS,eACtBC,MAAQb,IAAII,aAAa,iBAC7BV,eAAeoB,kBAAkB,oCAAqCD,MAAOf,QACxEiB,MAAMpB,aAAaqB"}